<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Goldzilla Macro Dashboard</title>
  <style>
    body {
      background-color: #111;
      color: #eee;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #FFD700;
      margin-top: 80px;
    }
    .section {
      margin-bottom: 40px;
    }
  </style>
</head>
<body>

<!-- ðŸ” TradingView Ticker Tape (Sticky Full Width) -->
<div class="tradingview-widget-container" id="ticker-bar">
  <div class="tradingview-widget-container__widget"></div>
  <div class="tradingview-widget-copyright">
    <a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank">
      <span class="blue-text">Track all markets on TradingView</span>
    </a>
  </div>
  </div>
  
<script>


  

  <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
  {
    "symbols": [
      { "proName": "FOREXCOM:SPXUSD", "title": "S&P 500 Index" },
      { "proName": "FOREXCOM:NSXUSD", "title": "US 100 Cash CFD" },
      { "proName": "FX_IDC:EURUSD", "title": "EUR to USD" },
      { "proName": "BITSTAMP:BTCUSD", "title": "Bitcoin" },
      { "proName": "BITSTAMP:ETHUSD", "title": "Ethereum" },
      { "description": "VIX", "proName": "PEPPERSTONE:VIX" },
      { "description": "USD", "proName": "CAPITALCOM:DXY" },
      { "description": "NVDA", "proName": "NASDAQ:NVDA" },
      { "description": "Apple", "proName": "NASDAQ:AAPL" },
      { "description": "Yuan / USD", "proName": "FX_IDC:CNYUSD" },
      { "description": "USD / Japan", "proName": "OANDA:USDJPY" },
      { "description": "TOP 1% Holding Wealth", "proName": "FRED:WFRBLT01026" },
      { "description": "Bottom 50% HW", "proName": "FRED:WFRBSB50215" }
    ],
    "showSymbolLogo": true,
    "isTransparent": false,
    "displayMode": "adaptive",
    "colorTheme": "dark",
    "locale": "en"
  }
  </script>
</div>

<!-- ðŸ“› HEADER -->
<h1>ðŸ“Š Goldzilla Macro Dashboard</h1>

<!-- ðŸŸ¨ Block 1: Gold & Silver -->
<div class="section" style="display: grid; grid-template-columns: repeat(3, 350px); gap: 8px; justify-content: start;">
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "TVC:GOLD", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "TVC:SILVER", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "TVC:USOIL", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "CAPITALCOM:DXY", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
</div>

<!-- ðŸŸ¨ Block 3: Indices Grid (2x3) -->
<div class="section" style="display: grid; grid-template-columns: repeat(3, 350px); gap: 12px;">
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "FOREXCOM:SPXUSD", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "FOREXCOM:DJI", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "FOREXCOM:NSXUSD", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
</div>

<!-- ðŸŸ¨ Block 4: Mag 7 + Sector Overview + News Feed -->
<div class="section" style="display: flex; gap: 20px; flex-wrap: wrap; align-items: flex-start;">
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>{"colorTheme":"dark","dateRange":"12M","showChart":true,"locale":"en","isTransparent":false,"showSymbolLogo":true,"width":"400","height":"650","tabs":[{"title":"Mag 7","symbols":[{"s":"NASDAQ:AAPL"},{"s":"NASDAQ:MSFT"},{"s":"NASDAQ:NVDA"},{"s":"NASDAQ:AMZN"},{"s":"NASDAQ:META"},{"s":"NASDAQ:GOOGL"},{"s":"NASDAQ:TSLA"}]}]}</script>
  </div>
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>{"colorTheme":"dark","dateRange":"12M","showChart":true,"locale":"en","isTransparent":false,"showSymbolLogo":true,"width":"400","height":"850","tabs":[{"title":"Sectors","symbols":[{"s":"AMEX:XLK"},{"s":"AMEX:XLI"},{"s":"AMEX:XLE"},{"s":"AMEX:XLB"},{"s":"AMEX:XLF"},{"s":"AMEX:XLV"},{"s":"AMEX:XLY"},{"s":"AMEX:XLP"},{"s":"AMEX:XLRE"},{"s":"AMEX:XLC"},{"s":"AMEX:XLU"}]}]}</script>
  </div>
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-timeline.js" async>{"feedMode":"all_symbols","isTransparent":false,"displayMode":"regular","width":400,"height":550,"colorTheme":"dark","locale":"en"}</script>
  </div>
</div>

<!-- ðŸŸ¨ Block 5: Hotlists + Crypto Screener + Forex Panel -->
<div class="section" style="display: flex; gap: 20px; flex-wrap: wrap; align-items: flex-start;">
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-hotlists.js" async>{"colorTheme":"dark","dateRange":"12M","exchange":"US","showChart":true,"locale":"en","isTransparent":false,"showSymbolLogo":false,"showFloatingTooltip":false,"width":"400","height":"550"}</script>
  </div>
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-screener.js" async>{"width":"400","height":550,"defaultColumn":"overview","screener_type":"crypto_mkt","displayCurrency":"USD","colorTheme":"dark","locale":"en"}</script>
  </div>
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-quotes.js" async>{"width":550,"height":550,"symbolsGroups":[{"name":"Forex","originalName":"Forex","symbols":[{"name":"FX:EURUSD","displayName":"EUR to USD"},{"name":"FX:USDJPY","displayName":"USD to JPY"},{"name":"FX:USDCAD","displayName":"USD to CAD"},{"name":"SGX:CYN2025","displayName":"Chinese Yuan v USD"},{"name":"FX:USDCHF","displayName":"USD v Swissy"},{"name":"FX:USDMXN","displayName":"USD to MXN"}]}],"showSymbolLogo":true,"isTransparent":false,"colorTheme":"dark","locale":"en","backgroundColor":"#131722"}</script>
  </div>
</div>
<div class="section">

<!-- ðŸ¦ COMEX Stress Module -->
<div style="background-color: #111; color: #FFD700; padding: 20px; margin-top: 40px; border: 2px solid #FFD700; border-radius: 12px; font-family: Arial, sans-serif; max-width: 100%; width: 100%; box-sizing: border-box; position: relative;">
  <div style="padding-right: 20px;">
    <h2 style="color:gold;">COMEX</h2>

    <hr style="border-color: #444; margin: 10px 0;">

    <h3 style="color:gold; font-size: 15px; margin: 8px 0;">COMEX Inventory</h3>
    <p style="color:white;"><strong>Registered:</strong> <span id="regVal">...</span> oz</p>
    <p style="color:white;"><strong>Eligible:</strong> <span id="eligVal">...</span> oz</p>
    <p style="color:white;"><strong>Combined:</strong> <span id="combVal">...</span> oz</p>

    <hr style="border-color: #444; margin: 10px 0;">

    <h3 style="color:gold; font-size: 15px; margin: 8px 0;">EFP 5-Day Avg</h3>
    <p style="color:white;"><strong>Value:</strong> <span id="efp5dma">...</span> contracts</p>

    <hr style="border-color: #444; margin: 10px 0;">

    <h3 style="color:gold; font-size: 15px; margin: 8px 0;">Gold-to-Paper Ratio</h3>
    <p style="color:white;"><strong>Ratio:</strong> <span id="gprRatio">â€“</span> (<span id="gprDate">â€“</span>)</p>

    <hr style="border-color: #444; margin: 10px 0;">

    <h3 style="color:gold; font-size: 15px; margin: 8px 0;">Total EFP Since May 14</h3>
    <p style="color:white;"><strong>Total:</strong> <span id="efpTotal">...</span> contracts</p>
    <p style="color:white;"><strong>Converted to Physical:</strong> <span id="efpMT">...</span> Metric Tons</p>

    <hr style="border-color: #444; margin: 10px 0;">

    <h3 style="color:gold; font-size: 15px; margin: 8px 0;">Volume Activity</h3>
    <p style="color:white;"><strong>Latest Volume:</strong> <span id="volTotal">...</span> contracts</p>
    <p style="color:white;"><strong>At-Close Volume:</strong> <span id="volClose">...</span> contracts</p>

    <hr style="border-color: #FFD700; margin: 10px 0;">

    <h3 style="color:gold; font-size: 15px; margin: 8px 0;">Total Stress Alert</h3>
    <p style="font-size: 14px; color:white;"><strong>Status:</strong> <span id="stressSignal" style="color: #FFD700; font-weight: bold;">...</span></p>
  </div>
</div>

<!-- âœ… Load COMEX Data from Google Sheets via JSONP -->
<script src="https://script.google.com/macros/s/AKfycbyOPPnuL_5OeSSGYTnShbOC0-BUNvGTldroBMjEzohbyiLWDP4cbGB2O1YSJGhf47It5Q/exec?callback=displayData"></script>

<script>
  function displayData(data) {
    const latest = data[data.length - 1];
    if (!latest) {
      console.error("No data returned from Google Sheets.");
      return;
    }

    console.log("âœ… Latest row from sheet:", latest);

    document.getElementById("regVal").textContent = latest["Registered Gold"] || "â€“";
    document.getElementById("eligVal").textContent = latest["Total Eligible"] || "â€“";
    document.getElementById("combVal").textContent = latest["Combined"] || "â€“";
    document.getElementById("efp5dma").textContent = latest["EFP 5DMA"] || "â€“";
    document.getElementById("efpTotal").textContent = latest["TOTAL EFP"] || "â€“";
    document.getElementById("efpMT").textContent = latest["Conversion"] || "â€“";
    document.getElementById("volTotal").textContent = latest["Total Volume"] || "â€“";
    document.getElementById("volClose").textContent = latest["At Close"] || "â€“";
    document.getElementById("stressSignal").textContent = latest["Signal"] || "â€“";

    if ((latest["Signal"] || "").toLowerCase().includes("high")) {
      document.getElementById("stressSignal").style.color = "red";
    }
  }
</script>

  

