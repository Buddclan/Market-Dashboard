<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Goldzilla Macro Dashboard</title>
  <style>
    body {
      background-color: #111;
      color: #eee;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #FFD700;
      margin-top: 80px;
    }
    .section {
      margin-bottom: 40px;
    }
  </style>
</head>
<body>

<!-- üîÅ TradingView Ticker Tape (Sticky Full Width) -->
<div class="tradingview-widget-container" id="ticker-bar">
  <div class="tradingview-widget-container__widget"></div>
  <div class="tradingview-widget-copyright">
    <a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank">
      <span class="blue-text">Track all markets on TradingView</span>
    </a>
  </div>
  <div id="debt-container"></div>

<script>
fetch("https://script.google.com/macros/s/YOUR_DEPLOYED_SCRIPT_ID/exec")
  .then(response => response.json())
  .then(data => {
    const container = document.getElementById("debt-container");
    // ...[rest of the JS from previous message]
  });
</script>

  <div id="debt-container"></div>

<script>
fetch("https://script.google.com/macros/s/YOUR_DEPLOYED_SCRIPT_ID/exec")
  .then(response => response.json())
  .then(data => {
    const container = document.getElementById("debt-container");
    // ...[rest of the JS from previous message]
  });
</script>

  <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
  {
    "symbols": [
      { "proName": "FOREXCOM:SPXUSD", "title": "S&P 500 Index" },
      { "proName": "FOREXCOM:NSXUSD", "title": "US 100 Cash CFD" },
      { "proName": "FX_IDC:EURUSD", "title": "EUR to USD" },
      { "proName": "BITSTAMP:BTCUSD", "title": "Bitcoin" },
      { "proName": "BITSTAMP:ETHUSD", "title": "Ethereum" },
      { "description": "VIX", "proName": "PEPPERSTONE:VIX" },
      { "description": "USD", "proName": "CAPITALCOM:DXY" },
      { "description": "NVDA", "proName": "NASDAQ:NVDA" },
      { "description": "Apple", "proName": "NASDAQ:AAPL" },
      { "description": "Yuan / USD", "proName": "FX_IDC:CNYUSD" },
      { "description": "USD / Japan", "proName": "OANDA:USDJPY" },
      { "description": "TOP 1% Holding Wealth", "proName": "FRED:WFRBLT01026" },
      { "description": "Bottom 50% HW", "proName": "FRED:WFRBSB50215" }
    ],
    "showSymbolLogo": true,
    "isTransparent": false,
    "displayMode": "adaptive",
    "colorTheme": "dark",
    "locale": "en"
  }
  </script>
</div>

<!-- üìõ HEADER -->
<h1>üìä Goldzilla Macro Dashboard</h1>

<!-- üü® Block 1: Gold & Silver -->
<div class="section" style="display: grid; grid-template-columns: repeat(3, 350px); gap: 8px; justify-content: start;">
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "TVC:GOLD", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "TVC:SILVER", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "TVC:USOIL", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "CAPITALCOM:DXY", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
</div>

<!-- üü® Block 3: Indices Grid (2x3) -->
<div class="section" style="display: grid; grid-template-columns: repeat(3, 350px); gap: 12px;">
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "FOREXCOM:SPXUSD", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "FOREXCOM:DJI", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
  <div class="tradingview-widget-container">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>{"symbol": "FOREXCOM:NSXUSD", "width": 350, "isTransparent": false, "colorTheme": "dark", "locale": "en"}</script>
  </div>
</div>

<!-- üü® Block 4: Mag 7 + Sector Overview + News Feed -->
<div class="section" style="display: flex; gap: 20px; flex-wrap: wrap; align-items: flex-start;">
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>{"colorTheme":"dark","dateRange":"12M","showChart":true,"locale":"en","isTransparent":false,"showSymbolLogo":true,"width":"400","height":"650","tabs":[{"title":"Mag 7","symbols":[{"s":"NASDAQ:AAPL"},{"s":"NASDAQ:MSFT"},{"s":"NASDAQ:NVDA"},{"s":"NASDAQ:AMZN"},{"s":"NASDAQ:META"},{"s":"NASDAQ:GOOGL"},{"s":"NASDAQ:TSLA"}]}]}</script>
  </div>
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>{"colorTheme":"dark","dateRange":"12M","showChart":true,"locale":"en","isTransparent":false,"showSymbolLogo":true,"width":"400","height":"850","tabs":[{"title":"Sectors","symbols":[{"s":"AMEX:XLK"},{"s":"AMEX:XLI"},{"s":"AMEX:XLE"},{"s":"AMEX:XLB"},{"s":"AMEX:XLF"},{"s":"AMEX:XLV"},{"s":"AMEX:XLY"},{"s":"AMEX:XLP"},{"s":"AMEX:XLRE"},{"s":"AMEX:XLC"},{"s":"AMEX:XLU"}]}]}</script>
  </div>
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-timeline.js" async>{"feedMode":"all_symbols","isTransparent":false,"displayMode":"regular","width":400,"height":550,"colorTheme":"dark","locale":"en"}</script>
  </div>
</div>

<!-- üü® Block 5: Hotlists + Crypto Screener + Forex Panel -->
<div class="section" style="display: flex; gap: 20px; flex-wrap: wrap; align-items: flex-start;">
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-hotlists.js" async>{"colorTheme":"dark","dateRange":"12M","exchange":"US","showChart":true,"locale":"en","isTransparent":false,"showSymbolLogo":false,"showFloatingTooltip":false,"width":"400","height":"550"}</script>
  </div>
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-screener.js" async>{"width":"400","height":550,"defaultColumn":"overview","screener_type":"crypto_mkt","displayCurrency":"USD","colorTheme":"dark","locale":"en"}</script>
  </div>
  <div class="tradingview-widget-container" style="min-width: 400px;">
    <div class="tradingview-widget-container__widget"></div>
    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-quotes.js" async>{"width":550,"height":550,"symbolsGroups":[{"name":"Forex","originalName":"Forex","symbols":[{"name":"FX:EURUSD","displayName":"EUR to USD"},{"name":"FX:USDJPY","displayName":"USD to JPY"},{"name":"FX:USDCAD","displayName":"USD to CAD"},{"name":"SGX:CYN2025","displayName":"Chinese Yuan v USD"},{"name":"FX:USDCHF","displayName":"USD v Swissy"},{"name":"FX:USDMXN","displayName":"USD to MXN"}]}],"showSymbolLogo":true,"isTransparent":false,"colorTheme":"dark","locale":"en","backgroundColor":"#131722"}</script>
  </div>
</div>
<div class="section">
 <!-- üí≥ Household Debt Stress -->
<div style="background-color: #111; color: #FFD700; padding: 20px; margin-top: 40px; border: 2px solid #FFD700; border-radius: 12px; font-family: Arial, sans-serif;">
  <h2 style="color:hotpink;">üí≥ Household Debt Stress</h2>
  <div id="debt-data" style="color:white;">Loading data...</div>
</div>

<script>
fetch("https://script.google.com/macros/s/AKfycbyqOIRdD09MMUyTOrWhPVFMyhnlvcDXKtN7wWjb6rTkIXHTlc1CHfANIvYVXasQAuaM/exec")
  .then(response => response.json())
  .then(data => {
    const container = document.getElementById("debt-data");

    const filtered = data.filter(row =>
      row["Category"] &&
      (row["Q4 2023"] !== "" || row["Q4 2024"] !== "" || row["Q1 2025"] !== "")
    );

    let html = `<table style="width:100%; border-collapse:collapse; text-align:center; color:white;">
      <thead>
        <tr style="border-bottom:1px solid #666;">
          <th style="text-align:left;">Category</th>
          <th>Q4 2023</th>
          <th>Q4 2024</th>
          <th>Q1 2025</th>
          <th>‚ÜóÔ∏è Trend</th>
          <th>‚ö†Ô∏è Signal</th>
        </tr>
      </thead>
      <tbody>`;

    filtered.forEach((row, i) => {
      const q4 = parseFloat(row["Q4 2024"]);
      const q1 = parseFloat(row["Q1 2025"]);
      let trend = "", signal = "";

      if (!isNaN(q4) && !isNaN(q1)) {
        trend = q1 > q4 ? "üî∫" : q1 < q4 ? "üîª" : "‚û°Ô∏è";
        if (q1 >= 7) signal = "üî¥";
        else if (q1 >= 3) signal = "üü†";
        else if (q1 > 0) signal = "üü¢";
      }

      html += `
        <tr style="border-bottom: 1px solid #333;">
          <td style="text-align:left;">${row["Category"]}</td>
          <td>${row["Q4 2023"] ?? ""}</td>
          <td>${row["Q4 2024"] ?? ""}</td>
          <td>${row["Q1 2025"] ?? ""}</td>
          <td>${trend}</td>
          <td>${signal}</td>
        </tr>`;

      // Inject spacing and yellow line after "Total Debt"
      if (row["Category"]?.toLowerCase().includes("total household debt")) {
        html += `
          <tr><td colspan="6" style="height: 20px;"></td></tr>
          <tr>
            <td colspan="6" style="color:gold; font-weight:bold; font-size:1.1em; text-align:left;">üü° 90+ Delinquencies</td>
          </tr>
          <tr><td colspan="6"><hr style="border: 1px solid gold;"></td></tr>`;
      }
    });

    html += `</tbody></table>`;
    container.innerHTML = html;
  })
  .catch(error => {
    console.error("Error fetching debt data:", error);
    document.getElementById("debt-data").innerHTML = "<span style='color:red;'>‚ö†Ô∏è Failed to load data.</span>";
  });
</script>

  
<div style="background-color: #1c1c1c; color: #f0f0f0; font-family: Arial, sans-serif; padding: 20px; border: 4px solid gold; border-radius: 8px; box-shadow: 0 0 30px gold; max-width: 960px; margin: auto; animation: pulseGoldFrame 2s infinite alternate;">
  <h2 style="color: #FFD700; margin-bottom: 10px;">üè¶ COMEX</h2>
  <p style="font-size: 14px; color: #cccccc;">Current COMEX stress score based on inventory and delivery dynamics: <strong style="color:#FFCC00">3</strong> ‚Äì üü° Moderate Risk</p>

  <hr style="border-color: #444;">

  <h3 style="color: #FFD700;">üì¶ COMEX Inventory</h3>
  <p><strong>Registered:</strong> 21,417,118 oz <span style="color: #66FF66;">(+97,707 oz)</span> ‚Äì üü† Rising Delivery Demand</p>
  <p><strong>Eligible:</strong> 16,932,486 oz <span style="color: #FF6666;">(‚àí537,296 oz)</span> ‚Äì üü† Physical Outflow</p>
  <p><strong>Combined:</strong> 38,349,604 oz <span style="color: #FF6666;">(‚àí439,589 oz)</span> ‚Äì üü° No Inventory Growth</p>

  <hr style="border-color: #444;">

  <h3 style="color: #FFD700;">üìà EFP 5-Day Avg</h3>
  <p><strong>Value:</strong> 2,475 contracts ‚Äì üü† Elevated Conversions</p>
  <p><strong>Interpretation:</strong> Rising physical conversion activity from futures</p>

  <hr style="border-color: #444;">

  <h3 style="color: #FFD700;">üì¶ Total EFP Since May 14</h3>
  <p><strong>Total:</strong> 23,630 contracts</p>
  <p><strong>Converted to Physical:</strong> 73.50 Metric Tons</p>
  <p><strong>Interpretation:</strong> Consistent delivery demand reflects off-exchange pressure</p>

  <hr style="border-color: #444;">

  <h3 style="color: #FFD700;">üìä Volume Activity</h3>
  <p><strong>Latest Volume:</strong> 193,512 contracts (June 2)</p>
  <p><strong>At-Close Volume:</strong> 1,585 contracts</p>
  <p><strong>Interpretation:</strong> Settlement-hour activity hints at strategic unwinding or exposure management</p>

  <hr style="border-color: #FFD700;">

  <h3 style="color: #FFD700;">üîª Total Stress Alert</h3>
  <p style="font-size: 16px;"><strong>Status:</strong> <span style="color: #FFD700; font-weight: bold;">üü° MODERATE RISK</span></p>
  <p style="color: #bbb;">Stress is present but below DEFCON thresholds. Continue monitoring EFP levels and combined drawdowns.</p>
</div>

<style>
@keyframes blinkText {
  0%   { opacity: 1; }
  50%  { opacity: 0.4; }
  100% { opacity: 1; }
}

@keyframes pulseGoldFrame {
  0% {
    box-shadow: 0 0 20px gold;
  }
  100% {
    box-shadow: 0 0 40px gold;
  }
}
</style>

<div style="margin-top: 40px; background-color: #111; padding: 15px; border-top: 2px solid #FFD700; text-align: center; font-size: 14px; color: #999;">
  Historical COMEX stress trends and signal charts coming soon...
</div>


  <div style="margin-top: 40px; background-color: #1a1a1a; padding: 20px; border: 2px dashed gold; border-radius: 8px;">
  <h3 style="color: #FFD700;">üìâ Trend Explorer (Beta)</h3>

  <!-- Embedded Sheet Chart Placeholder -->
  <iframe 
    src="https://docs.google.com/spreadsheets/d/e/YOUR_PUBLISHED_CHART_LINK/pubchart?oid=12345678&amp;format=interactive"
    width="100%" 
    height="350"
    style="border: none; border-radius: 6px; box-shadow: 0 0 10px rgba(255,215,0,0.4);">
  </iframe>

  <p style="color: #bbb; font-size: 13px; margin-top: 10px;">Above: 14-day trend in Registered Gold. Use chart menu (‚ãÆ) to export or toggle view.</p>

  <div style="margin-top: 20px;">
    <button onclick="toggleDetail()" style="background-color: gold; border: none; padding: 8px 12px; border-radius: 6px; font-weight: bold; cursor: pointer;">
      üîç Show More Insights
    </button>
  </div>

  <div id="comexDetailPanel" style="display: none; margin-top: 15px; color: #ccc; font-size: 14px;">
    <p>üìå <strong>Why This Matters:</strong> Shrinking registered gold while EFP volumes rise can signal paper-to-physical pressure ‚Äî a key sign of stress.</p>
    <p>üìà We monitor both inventory and conversion behavior. This tool will soon allow side-by-side view of:</p>
    <ul style="padding-left: 20px;">
      <li>üì¶ Registered vs Combined inventory</li>
      <li>üìä EFP conversion intensity over time</li>
      <li>üìâ Open Interest vs Physical backing</li>
    </ul>
  </div>
</div>

<script>
function toggleDetail() {
  const panel = document.getElementById('comexDetailPanel');
  panel.style.display = (panel.style.display === 'none') ? 'block' : 'none';
}
</script>
